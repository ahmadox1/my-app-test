<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6185082009203383"
         crossorigin="anonymous"></script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار الشخصية - 10 أسئلة</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');
        body {
            font-family: 'Tajawal', sans-serif;
        }
        .question-card {
            transition: all 0.3s ease;
        }
        .question-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .option-btn {
            transition: all 0.2s ease;
        }
        .option-btn:hover {
            transform: scale(1.03);
        }
        .option-btn.selected {
            transform: scale(1.05);
        }
        .progress-bar {
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="bg-gradient-to-b from-blue-50 to-purple-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-indigo-800 mb-3">اختبار الشخصية</h1>
            <p class="text-lg text-gray-600">اكتشف جوانب شخصيتك من خلال 10 أسئلة دقيقة</p>
            <div class="w-full bg-gray-200 rounded-full h-4 mt-6">
                <div id="progress" class="progress-bar bg-gradient-to-r from-blue-500 to-purple-600 h-4 rounded-full" style="width: 0%"></div>
            </div>
            <p id="progress-text" class="text-sm text-gray-500 mt-2">0/10 مكتمل</p>
        </header>

        <div id="test-container" class="max-w-2xl mx-auto">
            <div id="intro-screen" class="bg-white rounded-xl shadow-lg p-8 text-center">
                <div class="text-6xl text-indigo-500 mb-6">
                    <i class="fas fa-brain"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-800 mb-4">مرحباً بك في اختبار الشخصية</h2>
                <p class="text-gray-600 mb-6">هذا الاختبار يتكون من 10 أسئلة تم توليدها باستخدام الذكاء الاصطناعي لتقييم مختلف جوانب شخصيتك. الإجابات ستساعدك على فهم نفسك بشكل أفضل.</p>
                <div class="flex flex-col space-y-3">
                    <button id="start-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-3 px-6 rounded-lg transition duration-300 transform hover:scale-105">
                        بدء الاختبار <i class="fas fa-play ml-2"></i>
                    </button>
                    <p class="text-sm text-gray-500"><i class="fas fa-clock mr-1"></i> الوقت المتوقع: 3-5 دقائق</p>
                </div>
            </div>

            <div id="questions-container" class="hidden">
                </div>

            <div id="results-screen" class="hidden bg-white rounded-xl shadow-lg p-8">
                <div class="text-center mb-8">
                    <div class="text-6xl text-green-500 mb-4">
                        <i class="fas fa-award"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">تم الانتهاء من الاختبار!</h2>
                    <p class="text-gray-600">شكراً لإجابتك على جميع الأسئلة. إليك تحليل شخصيتك:</p>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <div class="bg-blue-50 p-5 rounded-lg border border-blue-100">
                        <h3 class="font-bold text-blue-800 mb-2 flex items-center">
                            <i class="fas fa-lightbulb mr-2"></i> الجوانب الإيجابية
                        </h3>
                        <ul class="list-disc list-inside text-blue-700 space-y-1" id="positive-traits"></ul>
                    </div>
                    <div class="bg-purple-50 p-5 rounded-lg border border-purple-100">
                        <h3 class="font-bold text-purple-800 mb-2 flex items-center">
                            <i class="fas fa-exclamation-triangle mr-2"></i> الجوانب التي يمكن تطويرها
                        </h3>
                        <ul class="list-disc list-inside text-purple-700 space-y-1" id="improvement-traits"></ul>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-indigo-500 to-purple-600 p-5 rounded-lg text-white">
                    <h3 class="font-bold text-xl mb-3 flex items-center">
                        <i class="fas fa-chart-pie mr-2"></i> تحليل شخصيتك
                    </h3>
                    <p id="personality-analysis" class="mb-4"></p>
                    <div class="flex justify-center space-x-4 mt-6">
                        <button id="restart-btn" class="bg-white text-indigo-600 hover:bg-gray-100 font-medium py-2 px-6 rounded-lg transition duration-300">
                            إعادة الاختبار <i class="fas fa-redo ml-2"></i>
                        </button>
                        <button id="share-btn" class="bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-6 rounded-lg transition duration-300">
                            مشاركة النتيجة <i class="fab fa-whatsapp ml-2"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-4">
        <div class="max-w-2xl mx-auto bg-gray-100 p-4 rounded-lg text-center">
            <p class="text-sm text-gray-500 mb-2">الإعلانات</p>
        </div>
    </div>
    
    <script>
        const questions = [
            { question: "عند مواجهة مشكلة جديدة، كيف تتصرف عادةً؟", options: ["أحلل الموقف بعناية وأبحث عن حل منطقي", "أتبع حدسي وأختار ما أشعر أنه صحيح", "أستشير الآخرين قبل اتخاذ أي قرار", "أحاول تجنب المشكلة ما أمكن"], weights: [{L:2}, {I:2}, {S:1, C:1}, {C:2}] },
            { question: "كيف تصف علاقاتك مع الآخرين؟", options: ["لدي دائرة صغيرة من الأصدقاء المقربين", "أستمتع بالتواصل مع العديد من الأشخاص المختلفين", "أفضل قضاء الوقت بمفردي معظم الوقت", "أحاول إرضاء الجميع وأكون محبوباً"], weights: [{R:2}, {S:2}, {R:2}, {S:1, C:1}] },
            { question: "عندما تكون في موقف اجتماعي جديد، كيف تشعر؟", options: ["متحمس ومليء بالطاقة", "مرتاح ولكن أراقب الموقف أولاً", "متوتر قليلاً ولكن أتكيف مع الوقت", "أشعر بعدم الارتياح وأفضل المغادرة"], weights: [{S:2}, {R:1, L:1}, {C:1}, {R:2, C:1}] },
            { question: "كيف تتعامل مع المواعيد النهائية؟", options: ["أنهي المهام مبكراً وأكون مستعداً قبل الموعد", "أعمل بشكل أفضل تحت الضغط وأتركها حتى اللحظة الأخيرة", "أحاول الالتزام بالموعد ولكن أحياناً أتأخر", "أجد صعوبة في إدارة وقتي وغالباً ما أتأخر"], weights: [{O:2}, {F:2}, {F:1}, {O:-1, F:1}] },
            { question: "ما هو موقفك من التغيير؟", options: ["أرحب به وأرى فيه فرصاً جديدة", "أتقبله إذا كان ضرورياً", "أشعر بعدم الارتياح ولكني أتكيف مع الوقت", "أفضل البقاء على ما أعرفه وأقاوم التغيير"], weights: [{F:2}, {L:1, F:1}, {C:1}, {O:2, F:-1}] },
            { question: "كيف تتعامل مع النقد؟", options: ["أعتبره فرصة للتحسين والتعلم", "أحلله لأرى إن كان عادلاً ثم أتصرف بناءً عليه", "أشعر بالإهانة ولكن أحاول عدم إظهار ذلك", "أخذ الأمر على محمل شخصي وأشعر بالإحباط"], weights: [{L:2, F:1}, {L:1, C:1}, {C:1}, {I:2, C:-1}] },
            { question: "ما هو نهجك في تحقيق الأهداف؟", options: ["أضع خطة مفصلة وأتبعها بدقة", "لدي فكرة عامة وأترك مجالاً للمرونة", "أعمل بجد ولكن أحياناً أفقد التركيز", "أجد صعوبة في تحديد أهداف واضحة"], weights: [{O:2, L:1}, {F:2, I:1}, {F:1}, {O:-1}] },
            { question: "كيف تتصرف عندما تكون تحت ضغط كبير؟", options: ["أبقى هادئاً وأركز على الحلول", "أشعر بالتوتر ولكن أستمر في العمل", "أحتاج إلى استراحة لاستعادة تركيزي", "أشعر بالإرهاق وقد أفقد السيطرة على مشاعري"], weights: [{L:2, O:1}, {C:1}, {R:1}, {I:2, C:-1}] },
            { question: "ما مدى سهولة اتخاذك للقرارات المهمة؟", options: ["سهلة جداً، أعرف ما أريد", "أحتاج إلى بعض الوقت للتفكير ولكن أقرر بنفسي", "أجد صعوبة وأحتاج إلى مشورة الآخرين", "أؤجل القرار ما أمكن وأشعر بالقلق"], weights: [{L:2}, {L:1, I:1}, {S:1, C:1}, {C:2, I:-1}] },
            { question: "كيف تفضل قضاء وقت فراغك؟", options: ["مع الأصدقاء أو العائلة", "بممارسة هوايات إبداعية أو تعلم شيء جديد", "بالاسترخاء والراحة بمفردي", "بمشاهدة التلفاز أو تصفح الإنترنت دون هدف محدد"], weights: [{S:2}, {I:2, F:1}, {R:2}, {R:1}] }
        ];

        const introScreen = document.getElementById('intro-screen');
        const questionsContainer = document.getElementById('questions-container');
        const resultsScreen = document.getElementById('results-screen');
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const shareBtn = document.getElementById('share-btn');
        const progressBar = document.getElementById('progress');
        const progressText = document.getElementById('progress-text');
        
        let currentQuestion = 0;
        let answers = [];
        
        window.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const resultsParam = urlParams.get('results');
            if (resultsParam && resultsParam.length === questions.length) {
                const sharedAnswers = resultsParam.split('').map(Number);
                introScreen.classList.add('hidden');
                resultsScreen.classList.remove('hidden');
                displayResults(sharedAnswers);
                restartBtn.innerHTML = 'ابدأ اختبارك الخاص <i class="fas fa-pen-alt ml-2"></i>';
                restartBtn.onclick = () => { window.location.href = window.location.pathname; };
                shareBtn.classList.add('hidden');
            }
        });

        startBtn.addEventListener('click', startTest);
        restartBtn.addEventListener('click', startTest);
        
        function startTest() {
            resultsScreen.classList.add('hidden');
            introScreen.classList.add('hidden');
            questionsContainer.classList.remove('hidden');
            currentQuestion = 0;
            answers = [];
            renderQuestion();
            updateProgress();
        }
        
        function renderQuestion() {
            const question = questions[currentQuestion];
            let questionHTML = `
                <div class="question-card bg-white rounded-xl shadow-md p-6 mb-6">
                    <div class="flex items-center mb-4">
                        <span class="bg-indigo-100 text-indigo-800 font-bold py-1 px-3 rounded-full text-sm">${currentQuestion + 1}/10</span>
                        <h3 class="text-xl font-semibold text-gray-800 mr-3">${question.question}</h3>
                    </div>
                    <div class="space-y-3" id="options-container">
                        ${question.options.map((option, index) => `<button class="option-btn w-full text-left bg-gray-50 hover:bg-indigo-50 border border-gray-200 hover:border-indigo-300 rounded-lg py-3 px-4 text-gray-700 hover:text-indigo-700" data-index="${index}" onclick="selectOption(this, ${index})"><i class="far fa-circle mr-2"></i> ${option}</button>`).join('')}
                    </div>
                </div>
                <div class="flex justify-between mt-6">
                    ${currentQuestion > 0 ? `<button onclick="prevQuestion()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-6 rounded-lg"><i class="fas fa-arrow-right mr-2"></i> السابق</button>` : `<div></div>`}
                    <button id="next-btn" onclick="nextQuestion()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-6 rounded-lg ${answers[currentQuestion] === undefined ? 'opacity-50 cursor-not-allowed' : ''}" ${answers[currentQuestion] === undefined ? 'disabled' : ''}>التالي <i class="fas fa-arrow-left ml-2"></i></button>
                </div>`;
            questionsContainer.innerHTML = questionHTML;
            if (answers[currentQuestion] !== undefined) {
                const selectedBtn = questionsContainer.querySelector(`button[data-index="${answers[currentQuestion]}"]`);
                if(selectedBtn) { selectOption(selectedBtn, answers[currentQuestion]); }
            }
        }
        
        window.selectOption = function(button, optionIndex) {
            document.querySelectorAll('.option-btn').forEach(opt => {
                opt.classList.remove('selected', 'bg-indigo-100', 'border-indigo-400', 'text-indigo-700');
                opt.querySelector('i').className = 'far fa-circle mr-2';
            });
            button.classList.add('selected', 'bg-indigo-100', 'border-indigo-400', 'text-indigo-700');
            button.querySelector('i').className = 'fas fa-check-circle mr-2';
            answers[currentQuestion] = optionIndex;
            document.getElementById('next-btn').classList.remove('opacity-50', 'cursor-not-allowed');
            document.getElementById('next-btn').disabled = false;
        }
        
        window.nextQuestion = function() {
            if (answers[currentQuestion] === undefined) return;
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                renderQuestion();
            } else {
                questionsContainer.classList.add('hidden');
                resultsScreen.classList.remove('hidden');
                shareBtn.classList.remove('hidden');
                restartBtn.innerHTML = 'إعادة الاختبار <i class="fas fa-redo ml-2"></i>';
                displayResults(answers);
            }
            updateProgress();
        }
        
        window.prevQuestion = function() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
                updateProgress();
            }
        }
        
        function updateProgress() {
            const answeredCount = answers.filter(a => a !== undefined).length;
            const progress = ((answeredCount) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
            progressText.textContent = `${answeredCount}/10 مكتمل`;
        }
        
        function displayResults(answersArray) {
            progressBar.style.width = `100%`;
            progressText.textContent = `10/10 مكتمل`;
            const personalityTraits = analyzePersonality(answersArray);
            document.getElementById('positive-traits').innerHTML = personalityTraits.positive.map(trait => `<li>${trait}</li>`).join('');
            document.getElementById('improvement-traits').innerHTML = personalityTraits.improvement.map(trait => `<li>${trait}</li>`).join('');
            document.getElementById('personality-analysis').textContent = personalityTraits.analysis;
            setupShareButton(answersArray);
        }

        function setupShareButton(answersArray) {
             shareBtn.onclick = () => {
                const resultsString = answersArray.join('');
                const baseUrl = window.location.origin + window.location.pathname;
                const shareUrl = `${baseUrl}?results=${resultsString}`;
                const shareText = `شاهد نتيجة اختبار الشخصية الخاص بي، وجرّب الاختبار بنفسك!\n\n${shareUrl}`;
                if (navigator.share) {
                     navigator.share({ title: 'نتيجة اختبار الشخصية', text: shareText }).catch(console.error);
                 } else {
                     window.open(`https://wa.me/?text=${encodeURIComponent(shareText)}`, '_blank');
                 }
            };
        }
        
        // --- [دالة التحليل المُصحَّحة] ---
        function analyzePersonality(answers) {
            const scores = { L: 0, I: 0, S: 0, R: 0, O: 0, F: 0, C: 0 };
            
            answers.forEach((answerIndex, questionIndex) => {
                const weights = questions[questionIndex].weights[answerIndex];
                for (const trait in weights) {
                    scores[trait] += weights[trait];
                }
            });

            let positive = [];
            let improvement = [];
            let mainTraits = [];

            // تحديد المحاور الرئيسية
            if (scores.L > scores.I) {
                mainTraits.push("تحليلي");
                positive.push("تعتمد على التفكير المنطقي وتحليل المعطيات.");
                improvement.push("جرّب أن تثق بحدسك في بعض القرارات البسيطة.");
            } else {
                mainTraits.push("حدسي");
                positive.push("تتمتع بحدس قوي وفهم عميق للمشاعر.");
                improvement.push("ادعم قراراتك ببعض التحليل المنطقي لزيادة الثقة.");
            }

            if (scores.S > scores.R) {
                mainTraits.push("اجتماعي");
                positive.push("تستمد طاقتك من التفاعل مع الآخرين وتبني العلاقات بسهولة.");
                improvement.push("لا تنسَ تخصيص بعض الوقت لنفسك لإعادة شحن طاقتك.");
            } else {
                mainTraits.push("متحفظ");
                positive.push("تقدر وقتك الخاص وتستمتع بالهدوء والتركيز العميق.");
                improvement.push("حاول الخروج من منطقة راحتك والمشاركة في مناسبات اجتماعية جديدة.");
            }

            if (scores.O > scores.F) {
                mainTraits.push("منظم");
                positive.push("تفضل التخطيط المسبق وتسعى دائمًا للترتيب والدقة.");
                improvement.push("كن أكثر مرونة في تقبل التغييرات المفاجئة وغير المخطط لها.");
            } else {
                mainTraits.push("مرن");
                positive.push("تتكيف بسهولة مع المتغيرات ولا تخشى الخروج عن الخطة.");
                improvement.push("ضع بعض الخطط الأساسية لأهدافك طويلة الأمد لضمان تحقيقها.");
            }

            if (positive.length < 2) positive.push("لديك شخصية متوازنة في مختلف الجوانب.");
            if (improvement.length < 2) improvement.push("استمر في استكشاف جوانب شخصيتك وتطويرها.");

            const analysisText = `بناءً على إجاباتك، أنت شخصية تميل إلى أن تكون **${mainTraits.join(" و")}**. لديك مزيج فريد من الصفات يجعلك مميزًا. نقاط قوتك تكمن في كونك ${positive.slice(0, 2).join("، بالإضافة إلى أنك ")}. يمكنك تحقيق المزيد من النمو عبر ${improvement.slice(0, 2).join("، و")}.`;

            return {
                positive: positive.slice(0, 2),
                improvement: improvement.slice(0, 2),
                analysis: analysisText
            };
        }
    </script>
</body>
</html>
